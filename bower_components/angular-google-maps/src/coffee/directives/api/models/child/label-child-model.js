// Generated by CoffeeScript 1.7.1
var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

angular.module("google-maps.directives.api.models.child").factory("MarkerLabelChildModel", [
  "BaseObject", "GmapUtil", function(BaseObject, GmapUtil) {
    var MarkerLabelChildModel;
    MarkerLabelChildModel = (function(_super) {
      __extends(MarkerLabelChildModel, _super);

      MarkerLabelChildModel.include(GmapUtil);

      function MarkerLabelChildModel(gMarker, options, map) {
        this.destroy = __bind(this.destroy, this);
        this.setOptions = __bind(this.setOptions, this);
        var self;
        MarkerLabelChildModel.__super__.constructor.call(this);
        self = this;
        this.gMarker = gMarker;
        this.setOptions(options);
        this.gMarkerLabel = new MarkerLabel_(this.gMarker, options.crossImage, options.handCursor);
        this.gMarker.set("setMap", function(theMap) {
          self.gMarkerLabel.setMap(theMap);
          return google.maps.Marker.prototype.setMap.apply(this, arguments);
        });
        this.gMarker.setMap(map);
      }

      MarkerLabelChildModel.prototype.setOption = function(optStr, content) {

        /*
           COMENTED CODE SHOWS AWFUL CHROME BUG in Google Maps SDK 3, still happens in version 3.16
          any animation will cause markers to disappear
         */
        return this.gMarker.set(optStr, content);
      };

      MarkerLabelChildModel.prototype.setOptions = function(options) {
        var _ref, _ref1;
        if (options != null ? options.labelContent : void 0) {
          this.gMarker.set("labelContent", options.labelContent);
        }
        if (options != null ? options.labelAnchor : void 0) {
          this.gMarker.set("labelAnchor", this.getLabelPositionPoint(options.labelAnchor));
        }
        this.gMarker.set("labelClass", options.labelClass || 'labels');
        this.gMarker.set("labelStyle", options.labelStyle || {
          opacity: 100
        });
        this.gMarker.set("labelInBackground", options.labelInBackground || false);
        if (!options.labelVisible) {
          this.gMarker.set("labelVisible", true);
        }
        if (!options.raiseOnDrag) {
          this.gMarker.set("raiseOnDrag", true);
        }
        if (!options.clickable) {
          this.gMarker.set("clickable", true);
        }
        if (!options.draggable) {
          this.gMarker.set("draggable", false);
        }
        if (!options.optimized) {
          this.gMarker.set("optimized", false);
        }
        options.crossImage = (_ref = options.crossImage) != null ? _ref : document.location.protocol + "//maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png";
        return options.handCursor = (_ref1 = options.handCursor) != null ? _ref1 : document.location.protocol + "//maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur";
      };

      MarkerLabelChildModel.prototype.destroy = function() {
        if ((this.gMarkerLabel.labelDiv_.parentNode != null) && (this.gMarkerLabel.eventDiv_.parentNode != null)) {
          return this.gMarkerLabel.onRemove();
        }
      };

      return MarkerLabelChildModel;

    })(BaseObject);
    return MarkerLabelChildModel;
  }
]);
